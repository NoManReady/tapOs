var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(f,l,m){f instanceof String&&(f=String(f));for(var k=f.length,b=0;b<k;b++){var h=f[b];if(l.call(m,h,b,f))return{i:b,v:h}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(f,l,m){f!=Array.prototype&&f!=Object.prototype&&(f[l]=m.value)};$jscomp.getGlobal=function(f){return"undefined"!=typeof window&&window===f?f:"undefined"!=typeof global&&null!=global?global:f};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(f,l,m,k){if(l){m=$jscomp.global;f=f.split(".");for(k=0;k<f.length-1;k++){var b=f[k];b in m||(m[b]={});m=m[b]}f=f[f.length-1];k=m[f];l=l(k);l!=k&&null!=l&&$jscomp.defineProperty(m,f,{configurable:!0,writable:!0,value:l})}};$jscomp.polyfill("Array.prototype.find",function(f){return f?f:function(f,m){return $jscomp.findInternal(this,f,m).v}},"es6","es3");
(function(f,l){"function"!==typeof define||!define.amd||"undefined"!=typeof nonUseAmd&&nonUseAmd?l():"undefined"!=typeof HTMLDev&&HTMLDev?define(["./signature"],l):define(["./signature.min"],l)})(window,function(f){var l,m;f=window;var k=f.kinggrid,b=window.Signature,h=window.jQuery;"use strict";var u=!1;f.JSON&&(u='{"x":"\u4e2d"}'!==f.JSON.stringify({x:"\u4e2d"}));var n=k.Utils,r=b.options;n.extend(b.options.template,{signInfoBtl:'<div class="kg-dialog kg-dialog-info kg-dialog-signedinfo" id="kg-signedinfo"><%var modified = this.signModified;%><%var timeVerify = this.timeVerify;%><div class="kg-title success <%modified?"kg-hide":""%>"><i class="kg-icon"></i><span>\u68c0\u6d4b\u7ed3\u679c\uff1a\u7b7e\u540d\u6570\u636e\u9a8c\u8bc1\u6b63\u5e38\uff01</span><%if(timeVerify!=null){%><span class="timestamp <%timeVerify==true?"green":"red"%>"><%timeVerify==true?"(\u65f6\u95f4\u6233\u53ef\u4fe1\u4efb)":"(\u65f6\u95f4\u6233\u4e0d\u53ef\u4fe1\u4efb)"%></span><%}%></div><div class="kg-title danger  <%modified?"":"kg-hide"%> "><i class="kg-icon"></i><span>\u68c0\u6d4b\u7ed3\u679c\uff1a\u7b7e\u540d\u6570\u636e\u88ab\u7be1\u6539\uff01</span><%if(timeVerify!=null){%><span class="timestamp <%timeVerify==true?"green":"red"%>"><%timeVerify==true?"(\u65f6\u95f4\u6233\u53ef\u4fe1\u4efb)":"(\u65f6\u95f4\u6233\u4e0d\u53ef\u4fe1\u4efb)"%></span><%}%></div><div class="kg-content"><div class="kg-tab"><ul class="kg-nav clearfix"><li class="active"><a href="#" kg-target="certinfo">\u8bc1\u4e66\u4fe1\u606f</a></li></ul><%var certinfo = this.signatureData.signMeta.certinfo; %><div class="kg-tab-content"><div class="kg-tab-pane active certinfo"><div class="kg-meta"><div class="clearfix kg-item "><label class="kg-label">\u7248\u672c\uff1a</label><span class="kg-value">V<%certinfo.version%></span></div><div class="clearfix kg-item "><label class="kg-label">\u5e8f\u53f7\uff1a</label><span class="kg-value"><%certinfo.serialNumber%></span></div><div class="clearfix kg-item "><label class="kg-label">\u7b7e\u540d\u7b97\u6cd5\uff1a</label><span class="kg-value"><%certinfo.algName%></span></div><div class="clearfix kg-item "><label class="kg-label">\u9881\u53d1\u8005\uff1a</label><span class="kg-value"><%certinfo.issuerDN%></span></div><div class="clearfix kg-item "><label class="kg-label">\u4f7f\u7528\u8005\uff1a</label><span class="kg-value"><%certinfo.subjectDN%></span></div><div class="clearfix kg-item "><label class="kg-label">\u6709\u6548\u671f\u4ece\uff1a</label><span class="kg-value"><%kinggrid.Utils.formatDate(new Date(certinfo.notBefore) , "yyyy-MM-dd hh:mm:ss")%></span></div><div class="clearfix kg-item "><label class="kg-label">\u81f3\uff1a</label><span class="kg-value"><%kinggrid.Utils.formatDate(new Date(certinfo.notAfter) , "yyyy-MM-dd hh:mm:ss")%></span></div></div></div></div></div></div></div>',
signatureInfoBtl:'<div class="kg-dialog kg-dialog-info" id="kg-sigantureinfo"><%var modified = this.modified;%><%var timeVerify = this.timeVerify;%><%var sealType = Signature.options.sealType;%><div class="kg-title success <%modified?"kg-hide":""%>"><i class="kg-icon"></i><span>\u68c0\u6d4b\u7ed3\u679c\uff1a\u4fdd\u62a4\u6570\u636e\u6b63\u5e38\uff01</span><%if(timeVerify!=null){%><span class="timestamp <%timeVerify==true?"green":"red"%>"><%timeVerify==true?"(\u65f6\u95f4\u6233\u53ef\u4fe1\u4efb)":"(\u65f6\u95f4\u6233\u4e0d\u53ef\u4fe1\u4efb)"%></span><%}%></div><div class="kg-title danger  <%modified?"":"kg-hide"%> "><i class="kg-icon"></i><span>\u68c0\u6d4b\u7ed3\u679c\uff1a\u4fdd\u62a4\u6570\u636e\u88ab\u7be1\u6539\uff01</span><%if(timeVerify!=null){%><span class="timestamp <%timeVerify==true?"green":"red"%>"><%timeVerify==true?"(\u65f6\u95f4\u6233\u53ef\u4fe1\u4efb)":"(\u65f6\u95f4\u6233\u4e0d\u53ef\u4fe1\u4efb)"%></span><%}%></div><div class="kg-content"><div class="kg-tab"><ul class="kg-nav clearfix"><li class=" <% modified?"":"active"%> "><a href="#" kg-target="signatureinfo">\u7b7e\u7ae0\u4fe1\u606f</a></li><%if(modified){%><li class=" <% modified?"active":""%> " ><a href="#" kg-target="modifieditems">\u7be1\u6539\u4fe1\u606f</a></li><%}%></ul><div class="kg-tab-content"><div class="kg-tab-pane <% modified?"":"active"%> signatureinfo"><% var SDATA = this.signatureData; %><% var modifiedItems = this.modifiedItems; %><div class="kg-meta"><div class="clearfix kg-item "><label class="kg-label">\u5e94\u7528\u7a0b\u5e8f\uff1a</label><span class="kg-value"><%timeVerify%><%SDATA.appname%></span></div><div class="clearfix kg-item "><label class="kg-label">\u6388\u6743\u5355\u4f4d\uff1a</label><span class="kg-value"><%SDATA.orgname%></span></div><div class="clearfix kg-item "><label class="kg-label">\u7528\u6237\u540d\u79f0\uff1a</label><span class="kg-value"><%SDATA.username%></span></div><div class="clearfix kg-item "><label class="kg-label">\u5bc6\u94a5\u5e8f\u5217\uff1a</label><span class="kg-value"><%SDATA.keysn%></span></div><div class="clearfix kg-item "><label class="kg-label">\u7b7e\u7ae0\u540d\u79f0\uff1a</label><span class="kg-value"><%SDATA.seal.signname%></span></div><div class="clearfix kg-item "><label class="kg-label">\u7b7e\u7ae0\u5e8f\u5217\uff1a</label><span class="kg-value"><%SDATA.seal.signsn%></span></div><div class="clearfix kg-item "><label class="kg-label">\u7b7e\u7ae0\u65e5\u671f\uff1a</label><span class="kg-value"><%SDATA.timestamp.signtime%></span></div><%if(sealType == "client" && SDATA.seal.headinfoex){%><div class="clearfix kg-item "><label class="kg-label">\u5236\u7ae0\u4eba\u540d\uff1a</label><span class="kg-value"><%SDATA.seal.headinfoex.sealProducer%></span></div><div class="clearfix kg-item "><label class="kg-label">\u5236\u7ae0\u65e5\u671f\uff1a</label><span class="kg-value"><%SDATA.seal.headinfoex.sealMakingTime%></span></div><%}%></div></div><%if(modified){%><%var modifiedItems = this.modifiedItems;%><% for(var i=0;i<modifiedItems.length;i++) {%><% var item = modifiedItems[i]; %><div class="kg-tab-pane modifieditems <% modified?"active":""%> "><div class="kg-meta"><div class="clearfix kg-item "><label class="kg-label" kg-field="<%item.field%>"><%item.desc%>\u7531\uff1a</label><span class="kg-value"><%this["_renderValue"](this["html2Escape"](item.orivalue)) %></span></div><div class="clearfix kg-item "><label class="kg-label">\u66f4\u6539\u4e3a\uff1a</label><span class="kg-value"><%this["_renderValue"](this["html2Escape"](item.newvalue))%></span></div></div></div><%}%><%}%></div></div></div></div>',
handwritedlg:'<div class="kg-dialog kg-dialog-info" style="width:<%this.canvasWidth%>px;" id="kg-handwrite" unselectable="on" onselectstart="return false;" style="-moz-user-select:none;"><div class="kg-hw-content"><div class="kg-hw-info kg-hw-model">\u6a21\u5f0f:<select id="hw_model"><option value="0">\u624b\u5199\u7b7e\u540d</option><option value="1">\u6587\u5b57\u7b7e\u6279</option></select></div><div class="kg-hw-info kg-hw-name">\u540d\u79f0:<input type="text" value="\u624b\u5199\u7b7e\u6279" id="nameid" style="width:100px;"/></div><div class="kg-hw-info kg-hw-color">\u989c\u8272:<select id="hw_color"><option value="black">\u9ed1</option><option value="red">\u7ea2</option><option value="blue">\u84dd</option><option value="green">\u7eff</option></select></div><div class="kg-hw-info kg-hw-linewidth kg-hw-handwrite">\u7b14\u5bbd:<select id="hw_width"><% for(var i=1;i<=8;i++) {%><option value="<%i%>"><%i%></option><%}%></select></div><div class="kg-hw-info kg-hw-fontFamily kg-hw-written">\u5b57\u4f53:<select id="hw_fontFamily"><% for(var i=0;i<this.fontFamily.length;i++) {%><option value="<%this.fontFamily[i].ename%>"><%this.fontFamily[i].zname%></option><%}%></select></div><div class="kg-hw-info kg-hw-fontSize kg-hw-written"><select id="hw_fontSize"><% for(var i=20;i<=80;i+=4) {%><option value="<%i%>"<%i==24?"selected":""%>><%i%></option><%}%></select></div></div><div class="kg-hw-canvas" style="width:<%this.canvasWidth%>px;height:<%this.canvasHeight%>px;"><div id="kg-hw-span" class="kg-hw-written kg-hw-text-span" style="width:<%this.canvasWidth%>px;height:<%this.canvasHeight%>px;" ></div><textarea class="kg-hw-written kg-hw-text-edit" spellcheck="false" style="width:<%this.canvasWidth%>px;height:<%this.canvasHeight%>px;"></textarea><canvas id="canvasId" style="postion:absolute;top:0px;" width="670" height="500"></canvas></div><div id="div-judge" style="display: block;height:38px;style="width:<%this.canvasWidth%>px;"" align="center"><button type="button" id="clearid" class="kg-button">\u6e05\u9664</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button type="button" id="okid" class="kg-button">\u7b7e\u540d</button></div></div>',
barcodedlg:'<div class="kg-dialog kg-dialog-info" id="kg-barcode"><label class="kg-label">\u4e8c\u7ef4\u7801\u5185\u5bb9\uff1a</label><textarea id="bcId"></textarea><br /><div id="output"><br /></div><div id="div-judge" style="display: block"><button type="button" id="bc_clearid" class="kg-button">\u6e05\u9664</button><button type="button" id="bc_okid" class="kg-button">\u786e\u5b9a</button></div></div>',scanBCdlg:'<div class="kg-dialog kg-dialog-info" id="kg-barcode"><div id="support"></div> <div id="contentHolder"><video id="video" width="320" height="320" autoplay></video><canvas style="display:none; background-color:#F00;" id="canvas_scanBC" width="320" height="320"></canvas> <br/> </div></div>'});
var w=kingPlus(),p,v;b.addLiseter("init",function(){p=b.aisleKing;for(var a=b.options.icons,e=0;e<a.length;++e){var g=a[e];switch(g.iconClass){case "kg-icon-move-":null!=b.options.icon_move_donot&&0==b.options.icon_move_donot&&(g.enable=!1);break;case "kg-icon-move":null!=b.options.icon_move&&0==b.options.icon_move&&(g.enable=!1);break;case "kg-icon-remove":null!=b.options.icon_remove&&0==b.options.icon_remove&&(g.enable=!1);break;case "kg-icon-sign":null!=b.options.icon_sign&&0==b.options.icon_sign&&
(g.enable=!1);break;case "kg-icon-signverify":null!=b.options.icon_signverify&&0==b.options.icon_signverify&&(g.enable=!1);break;case "kg-icon-sealinfo":null!=b.options.icon_sealinfo&&0==b.options.icon_sealinfo&&(g.enable=!1)}}});b.addLiseter("beforeVerify",function(){v=[];l=[];m=[]});b.addLiseter("eachVerify",function(a){a.broken&&(v.push(a),l.push(a.signatureData.seal.signsn),m.push(a.signatureData.seal.imgdata))});b.addLiseter("startMove",function(a,e,g){"client"==b.options.sealType&&b.options.moveable_self&&
(e=k.surry(b.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",b.options.clientCode),b.options.fjrsIsphone&&(e.invoke("SetParamByName","FJRSISPHONE",b.options.fjrsIsphone),e.invoke("SetParamByName","FJRSTOKEN",localStorage.getItem("fjrsToken"))),e.invoke("KGGetKeyOtherInfo","0").ret(function(c){c.result?(c=c.Res.substring(1,c.Res.length-1),a.keysn=c,a.keysn!=a.signatureData.keysn&&b.alert(k.msg("cannot_move","KG_MSG"))):b.alert(k.msg(c.errcode,"then"))}))});b.addLiseter("verify",
function(){});var q={},t;h(window).resize(function(){t&&clearTimeout(t);t=setTimeout(function(){for(var a in q){var e=h(q[a]),g=h(n.$(e.attr("elemid")));b.prototype.calSealPos.call(null,g,e)}},200)});n.extend(b.prototype,{_init:function(){var a=this;a.on("showAt",function(a){n.$(a.getAttribute("elemid")).getAttribute("display")||(q[a.id]=a)});a.on("removeAt",function(a){delete q[a.id]});a.on("beforeShowAt",function(a){3960<this.signatureData.seal.imgdata.length&&u&&(this.brokenImgDiv=a)});a.on("showAt",
function(e){if(a.brokenImgDiv){var g=a.signatureData.seal,c=g.signsn;p&&(p=k.surry(b.options.serverUrl),p.request(a.imageUrl,{signsn:c,sealImg:g.imgdata,sid:a.signatureid}).ret(function(c){c.result&&(c=c.imageUrl||a.imageUrl+"_",h(e).find(".kg-img").attr({src:b.options.serverUrl+c+"&a0=0&sid="+a.signatureid}),delete a.brokenImgDiv)}))}});a.on("showAt",function(e){e=h(e);if(void 0==b.options.image_sealinfo||1==b.options.image_sealinfo)if(0<=h().jquery.indexOf("1.4"))e.live("click",function(){var g=
a._verify(null,{sucCall:function(){a.signatureInfo()}});void 0!==b.options.verifySignatureInfo&&b.options.verifySignatureInfo&&b.options.verifySignatureInfo(a.modified,a.modifiedItems,a.signatureData)||null!=g&&a.signatureInfo()});else e.on("click",function(){var g=a._verify(null,{sucCall:function(){a.signatureInfo()}});void 0!==b.options.verifySignatureInfo&&b.options.verifySignatureInfo&&b.options.verifySignatureInfo(a.modified,a.modifiedItems,a.signatureData)||null!=g&&a.signatureInfo()});e.append('<div class="kgImgIcons kg-img-icons" ></div>')});
a.on("handleImg",function(b){var g=h(b);g.find(".kg-img-icon").remove();if(r.icons){g=g.children(".kg-img-icons");for(var c=r.icons.length-1;0<=c;c--){var d=r.icons[c];if(n.val(d.enable,a,b)){"doornotmove"==d.id&&(a.signatureData.moveable?(d.iconClass=d.iconClass.substring(0,13)+"not",d.title=k.msg("SignatureMoveNot","KG_TITLE"),d.value="0"):(d.iconClass=d.iconClass.substring(0,13)+"do",d.title=k.msg("SignatureMoveDo","KG_TITLE"),d.value="1"));if("moveSignature"==d.id&&!a.signatureData.moveable)break;
var e=h('<a href="#" title="'+d.title+'" class="kg-img-icon" id="kg-img-icon-'+d.id+"-"+this.signatureid+'"><i class="'+d.iconClass+'"></i></a>');d.value&&(e=h('<a href="#" title="'+d.title+'" class="kg-img-icon" id="kg-img-icon-'+d.id+"-"+this.signatureid+'" extval="'+d.value+'"><i class="'+d.iconClass+'"></i></a>'));g.append(e);d.exec&&d.exec.call(a,b);(function(b,c,d){e.click(function(c){c.imgDiv=b;d.call(a,c,b)})})(b,e,d.click||function(a){a.preventDefault();a.stopPropagation()})}}}})},signatureInfo:function(){this.html2Escape=
n.html2Escape;return this.showDialog("signatureInfoBtl",{target:this,onCancel:!1,onShow:function(){b.options.beginDlgShowCall&&b.options.beginDlgShowCall.call();var a=this.find(".kg-tab");this.tab=n.tab(a)}})},signInfo:function(){var a={title:k.msg("SignVerify","KG_TITLE"),target:this,onCancel:!1,onShow:function(){b.options.beginDlgShowCall&&b.options.beginDlgShowCall.call()}};return this.showDialog("signInfoBtl",a)},handWriteDlg:function(a,b){a.canvas_height=a.canvas_height||500;a.canvas_width=a.canvas_width||
670;this.canvasWidth=a.canvas_width;this.canvasHeight=a.canvas_height;this.fontFamily=w.fontFamily;var g={title:k.msg("HWSignature","KG_TITLE"),target:this,onCancel:!1},c=this.showDialog("handwritedlg",g);g=c.find("#canvasId")[0];if(g.getContext){var d=c.find(".kg-hw-text-span"),e=c.find(".kg-hw-text-edit"),f,h=new SignaturePad(g,a);c.find("#hw_width").val(a.lineSize||5);c.find("#hw_color").click(function(){var a=c.find("#hw_color").val();h.setColor(a);d.css({color:a});e.css({color:a})});c.find("#hw_model").change(function(a){"0"==
a.target.value?(c.find(".kg-hw-written").css({display:"none"}),c.find(".kg-hw-handwrite").css({display:"block"}),h.setWebHandWrite(f,{fontStyle:"normal",fontSize:d.css("font-size"),fontFamily:d.css("font-family"),fontColor:d.css("color")}),f=[],d.html(""),e.val("")):"1"==a.target.value&&(c.find(".kg-hw-handwrite").css({display:"none"}),c.find(".kg-hw-written").css({display:"block"}))});e.keyup(function(a){a=n.convertText(this.value);d.html(a);parseFloat(e.css("line-height"))*a.split("<br>").length>
parseFloat(e.css("height"))&&console.warn("\u6587\u5b57\u8d85\u8fc7\u9650\u5236");f=n.handleEdittable(d,a)});c.find("#hw_width").click(function(){var a=c.find("#hw_width").val();h.setSize(a)});c.find("#hw_fontFamily").change(function(a){d.css({"font-family":this.value});e.css({"font-family":this.value})});c.find("#hw_fontSize").change(function(a){d.css({"font-size":this.value+"px","line-height":6+1.2*this.value+"px"});e.css({"font-size":this.value+"px","line-height":6+1.2*this.value+"px"}).attr("rows",
1);f=n.handleEdittable(d,d.html())});g=c.find("#clearid");var l=c.find("#okid");g.click(function(){h.clear();f=[];d.html("");e.val("")});l.click(function(){c.close();h.setWebHandWrite(f,{fontStyle:"normal",fontSize:d.css("font-size"),fontFamily:d.css("font-family"),fontColor:d.css("color")});h.toDataURL(function(d){if(d=d.replace(/^data:image\/\w+;base64,/,""))d={height:a.image_height||"5.00",width:a.image_width||"6.70",imageData:d,name:c.find("#nameid").val()},b(d),c.remove()})});c.find(".ui-dialog-close").click(function(){c.close();
a.onCancel&&a.onCancel.call()})}else c.close(),a.onError?a.onError.call():this.error({errcode:"11113"},"then")},fingerPrintsDevice:function(a,e){var g=this;k.surry(b.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",b.options.clientCode).invoke("KGRunFingerPrints",a.device_type||"0",a.image_type||"gif","JSComServer","","").ret(function(b){if(b.result){var c=b.FingerPrintsMap,f=parseFloat(254*b.ImageWidth/9600).toFixed(2);b=parseFloat(254*b.ImageHeight/9600).toFixed(2);
e({width:a.image_height||f,height:a.image_width||b,imageData:c,name:"\u6307\u7eb9\u7b7e\u540d"})}else g.errorCallback(b,a.errorCall,"KGRunFingerPrints")})},handWriteDevice:function(a,e){var g=this;void 0!=a.copy_right&&null!=a.copy_right&&k.surry(b.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",b.options.clientCode).invoke("KGRunHandWritten",a.device_type||"0",a.copy_right,"JSComServer","","").ret(function(b){if(b.result){var d=b.HandWrittenValue,c=parseFloat(254*
b.ImageWidth/9600).toFixed(2);b=parseFloat(254*b.ImageHeight/9600).toFixed(2);e({width:a.image_height||c,height:a.image_width||b,imageData:d,name:"\u624b\u5199\u7b7e\u540d"})}else g.errorCallback(b,a.errorCall,"KGRunHandWritten")})},eqpHandWriter:function(a,e){var g=this;void 0!=a.Value&&null!=a.Value&&k.surry(b.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",b.options.clientCode).invoke("KGEQPHandWriter",a.Value,a.DllName,"JSComServer").ret(function(b){if(b.result){var d=
b.imagedata,c=parseFloat(254*b.imagewidth/9600).toFixed(2);b=parseFloat(254*b.imageheight/9600).toFixed(2);e({width:a.image_height||c,height:a.image_width||b,imageData:d,name:"\u624b\u5199\u5c4f\u7b7e\u540d"})}else g.errorCallback(b,a.errorCall,"KGEQPHandWriter")})},barCodeDlg:function(a,b){if(void 0!=a.content&&null!=a.content){var e=h("#output").qrcode(a.content);b({height:a.image_height||"5",width:a.image_width||"5",imageData:e,name:"\u4e8c\u7ef4\u7801"})}},scanBCDlg:function(a,b){var e={title:k.msg("scanBCSignature",
"KG_TITLE"),target:this,onCancel:!1},c=this.showDialog("scanBCdlg",e);try{var d=document.getElementById("canvas_scanBC").getContext("2d"),f=document.getElementById("video");e={video:!0,audio:!1};var l=!0,m=function(a){l=!1;a.PERMISSION_DENIED?alert("\u7528\u6237\u62d2\u7edd\u4e86\u6d4f\u89c8\u5668\u8bf7\u6c42\u5a92\u4f53\u7684\u6743\u9650","\u63d0\u793a"):a.NOT_SUPPORTED_ERROR?alert("\u5bf9\u4e0d\u8d77\uff0c\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u62cd\u7167\u529f\u80fd\uff0c\u8bf7\u4f7f\u7528\u5176\u4ed6\u6d4f\u89c8\u5668",
"\u63d0\u793a"):a.MANDATORY_UNSATISFIED_ERROR?alert("\u6307\u5b9a\u7684\u5a92\u4f53\u7c7b\u578b\u672a\u63a5\u6536\u5230\u5a92\u4f53\u6d41","\u63d0\u793a"):alert("\u7cfb\u7edf\u672a\u80fd\u83b7\u53d6\u5230\u6444\u50cf\u5934\uff0c\u8bf7\u786e\u4fdd\u6444\u50cf\u5934\u5df2\u6b63\u786e\u5b89\u88c5\u3002\u6216\u5c1d\u8bd5\u5237\u65b0\u9875\u9762\uff0c\u91cd\u8bd5","\u63d0\u793a")};if(navigator.getUserMedia){if(-1<navigator.userAgent.indexOf("MQQBrowser"))return alert("\u5bf9\u4e0d\u8d77\uff0c\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u62cd\u7167\u529f\u80fd\uff0c\u8bf7\u4f7f\u7528\u5176\u4ed6\u6d4f\u89c8\u5668",
"\u63d0\u793a"),!1;navigator.getUserMedia(e,function(a){f.src=a;f.play()},m)}else if(navigator.webkitGetUserMedia)navigator.webkitGetUserMedia(e,function(a){f.src=window.webkitURL.createObjectURL(a);f.play()},m);else if(navigator.mozGetUserMedia)navigator.mozGetUserMedia(e,function(a){f.src=window.URL.createObjectURL(a);f.play()},m);else if(navigator.msGetUserMedia)navigator.msGetUserMedia(e,function(a){h(document).scrollTop(h(window).height());f.src=window.URL.createObjectURL(a);f.play()},m);else return alert("\u5bf9\u4e0d\u8d77\uff0c\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u62cd\u7167\u529f\u80fd\uff0c\u8bf7\u4f7f\u7528\u5176\u4ed6\u6d4f\u89c8\u5668"),
!1;l&&alert("\u4e3a\u4e86\u83b7\u5f97\u66f4\u51c6\u786e\u7684\u6d4b\u8bd5\u7ed3\u679c\uff0c\u8bf7\u5c3d\u91cf\u5c06\u4e8c\u7ef4\u7801\u7f6e\u4e8e\u6846\u4e2d\uff0c\u7136\u540e\u8fdb\u884c\u62cd\u6444\u3001\u626b\u63cf\u3002 \u8bf7\u786e\u4fdd\u6d4f\u89c8\u5668\u6709\u6743\u9650\u4f7f\u7528\u6444\u50cf\u529f\u80fd");var n=setTimeout(function(){d&&(d.drawImage(f,0,0,320,320),h("#contentHolder").html5_qrcode(function(d){h("#read").html(d);c.close();alert(d);a.content=d;barCodeDlg(a,b);window.clearInterval(n)},
function(a){h("#read_error").html(a);c.close();window.clearInterval(n)},function(a){h("#vid_error").html(a);c.close();window.clearInterval(n)}))},200)}catch(x){printHtml("\u6d4f\u89c8\u5668\u4e0d\u652f\u6301HTML5 CANVAS")}}});b.addIcon({iconClass:"kg-icon-move",title:k.msg("moveSignature","KG_TITLE"),id:"moveSignature",enable:function(a){return this.canMove(a)},exec:function(a){var e=this;(function(a,c){0<=h().jquery.indexOf("1.4")?(h(c).live("touchstart mousedown",".kg-icon-move",function(b){a&&
e.runMove(b,c)}),h(c).live("touchstart mouseover",".kg-icon-move",function(d){void 0!==b.options.extra&&(d=c.attributes.signatureid.nodeValue)&&void 0!==b.options.extra[d]&&b.options.extra[d].icon_move&&(a=b.options.extra[d].icon_move())})):(h(c).on("touchstart mousedown",".kg-icon-move",function(b){a&&e.runMove(b,c)}),h(c).on("touchstart mouseover",".kg-icon-move",function(d){void 0!==b.options.extra&&(d=c.attributes.signatureid.nodeValue)&&void 0!==b.options.extra[d]&&b.options.extra[d].icon_move&&
(a=b.options.extra[d].icon_move())}))})(!0,a)}});b.addIcon({iconClass:"kg-icon-move-",title:k.msg("SignatureMoveNot","KG_TITLE"),id:"doornotmove",enable:!0,click:function(a){var e=this;a.preventDefault();a.stopPropagation();var f=a.target.parentElement,c=function(a){h(a).attr("extval")&&"0"==h(a).attr("extval")?e.changeMoveAble(!1):e.changeMoveAble(!0)};e.signatureData.html2?e.error({errcode:"11112"},"then"):"server"==b.options.sealType?b.options.keysn==e.signatureData.keysn?c(f):e.error({errcode:"11111"},
"then"):"client"==b.options.sealType&&e.sealService.getKeysn({},function(a){a==e.signatureData.keysn?c(f):e.error({errcode:"11111"},"then")})}});b.addIcon({iconClass:"kg-icon-remove",title:k.msg("RevokeSignature","KG_TITLE"),id:"revokeSignature",enable:function(){return this.canDelete()},click:function(a){a.preventDefault();a.stopPropagation();this.revokeSignature()}});b.addIcon({iconClass:"kg-icon-sign",title:k.msg("SignSignature","KG_TITLE"),id:"sign",enable:function(){return this.canSign()},click:function(a){a.preventDefault();
a.stopPropagation();a=this._verify(null,{sucCall:function(){this.signSignature()}});null!=a&&(a?this.signSignature():b.alert(k.msg("invalid_signdata","KG_MSG"),function(){b.options.beginDlgOkCall&&b.options.beginDlgOkCall.call()},function(){b.options.beginDlgShowCall&&b.options.beginDlgShowCall.call()}))}});b.addIcon({iconClass:"kg-icon-signverify",title:k.msg("SignVerify","KG_TITLE"),id:"verifysign",enable:function(){return this.signatureData.signMeta},click:function(a){a.preventDefault();a.stopPropagation();
var b=this;b.verifySignData(function(a){a.errcode?b.error(a):b.signInfo()})}});b.addIcon({iconClass:"kg-icon-sealinfo",title:k.msg("SignatureVerify","KG_TITLE"),id:"signatureInfo",enable:!0,click:function(a){a.preventDefault();a.stopPropagation();a=this._verify(null,{sucCall:function(){this.signatureInfo()}});void 0!==b.options.verifySignatureInfo&&b.options.verifySignatureInfo&&b.options.verifySignatureInfo(this.modified,this.modifiedItems,this.signatureData)||null!=a&&this.signatureInfo()}});return b});
// V2.0.0.400    
